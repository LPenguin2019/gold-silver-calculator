<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>é‡‘åŒ…é“¶è®¡ç®—å™¨</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 500px; margin: auto; background: #f8f8f8; }
    h2 { text-align: center; }
    label { display: block; margin: 10px 0 5px; }
    input, select, button { width: 100%; padding: 8px; margin-bottom: 15px; box-sizing: border-box; }
    button { background: #007aff; color: white; border: none; border-radius: 5px; font-size: 16px; }
    button:hover { background: #005bb5; }
    .result-total { font-size: 24px; font-weight: bold; color: #d9534f; text-align: center; margin-top: 20px; }
    .result-detail { font-size: 16px; color: #333; margin-top: 10px; line-height: 1.6; }
  </style>
</head>
<body>
  <h2>ğŸ’° é‡‘åŒ…é“¶è®¡ç®—å™¨</h2>

  <label>é‡‘ä»·ï¼ˆå…ƒ/å…‹ï¼‰</label>
  <input type="number" id="goldPrice" placeholder="è¯·è¾“å…¥é‡‘ä»·">

  <label>é“¶ä»·ï¼ˆå…ƒ/å…‹ï¼‰</label>
  <input type="number" id="silverPrice" placeholder="è¯·è¾“å…¥é“¶ä»·">

  <label>é‡‘å…‹é‡</label>
  <input type="number" id="goldWeight" placeholder="è¯·è¾“å…¥é‡‘å…‹é‡">

  <label>é“¶å…‹é‡</label>
  <input type="number" id="silverWeight" placeholder="è¯·è¾“å…¥é“¶å…‹é‡">

  <label>æ‰‹å·¥è´¹æ¨¡å¼</label>
  <select id="feeMode">
    <option value="fixed">å›ºå®šæ€»é¢</option>
    <option value="per_gram">æŒ‰å…‹ä»·</option>
  </select>

  <div id="fixedFeeBox">
    <label>å›ºå®šæ‰‹å·¥è´¹ï¼ˆå…ƒï¼‰</label>
    <input type="number" id="fixedFee" placeholder="è¯·è¾“å…¥å›ºå®šå·¥è´¹">
  </div>

  <div id="perGramBox" style="display:none;">
    <label>æ‰‹å·¥å•ä»·ï¼ˆå…ƒ/å…‹ï¼‰</label>
    <input type="number" id="feePerGram" placeholder="è¯·è¾“å…¥æ‰‹å·¥å•ä»·">
  </div>

  <label>æŠ˜æ‰£ï¼ˆä¸å¡«=ä¸æ‰“æŠ˜, 1=åŸä»·, 0.88=88æŠ˜ï¼‰</label>
  <input type="number" step="0.01" id="discount" placeholder="è¯·è¾“å…¥æŠ˜æ‰£ï¼ˆå¯é€‰ï¼‰">

  <button onclick="calculate()">è®¡ç®—ä»·æ ¼</button>

  <div id="result"></div>

  <script>
    // è¯»å–æœ¬åœ°å­˜å‚¨çš„é‡‘ä»·é“¶ä»·
    document.getElementById("goldPrice").value = localStorage.getItem("goldPrice") || "";
    document.getElementById("silverPrice").value = localStorage.getItem("silverPrice") || "";

    // æ‰‹å·¥è´¹æ¨¡å¼åˆ‡æ¢
    document.getElementById("feeMode").addEventListener("change", function() {
      if (this.value === "fixed") {
        document.getElementById("fixedFeeBox").style.display = "block";
        document.getElementById("perGramBox").style.display = "none";
      } else {
        document.getElementById("fixedFeeBox").style.display = "none";
        document.getElementById("perGramBox").style.display = "block";
      }
    });

    function calculate() {
      const goldPrice = parseFloat(document.getElementById("goldPrice").value) || 0;
      const silverPrice = parseFloat(document.getElementById("silverPrice").value) || 0;
      const goldWeight = parseFloat(document.getElementById("goldWeight").value) || 0;
      const silverWeight = parseFloat(document.getElementById("silverWeight").value) || 0;
      const feeMode = document.getElementById("feeMode").value;
      const fixedFee = parseFloat(document.getElementById("fixedFee").value) || 0;
      const feePerGram = parseFloat(document.getElementById("feePerGram").value) || 0;
      let discount = parseFloat(document.getElementById("discount").value);
      if (isNaN(discount)) discount = 1; // ä¸è¾“å…¥æŠ˜æ‰£ = é»˜è®¤1

      // ä¿å­˜é‡‘ä»·é“¶ä»·ï¼Œä¸‹æ¬¡è‡ªåŠ¨å¸¦å‡º
      localStorage.setItem("goldPrice", goldPrice);
      localStorage.setItem("silverPrice", silverPrice);

      let goldTotal = goldPrice * goldWeight;
      let silverTotal = silverPrice * silverWeight;
      let fee = 0;

      if (feeMode === "fixed") {
        fee = fixedFee * discount;
      } else {
        let totalWeight = goldWeight + silverWeight;
        fee = totalWeight * feePerGram * discount;
      }

      let total = goldTotal + silverTotal + fee;

      // è¾“å‡ºç»“æœï¼ˆæ€»ä»·æœ€æ˜¾çœ¼ï¼Œä¸‹é¢å±•ç¤ºæ˜ç»†ï¼‰
      document.getElementById("result").innerHTML = `
        <div class="result-total">æ€»ä»·æ ¼ï¼š${total.toFixed(2)} å…ƒ</div>
        <div class="result-detail">
          é‡‘ä»·éƒ¨åˆ†ï¼š${goldTotal.toFixed(2)} å…ƒ<br>
          é“¶ä»·éƒ¨åˆ†ï¼š${silverTotal.toFixed(2)} å…ƒ<br>
          æ‰‹å·¥è´¹éƒ¨åˆ†ï¼š${fee.toFixed(2)} å…ƒ
        </div>
      `;
    }
  </script>
</body>
</html>
